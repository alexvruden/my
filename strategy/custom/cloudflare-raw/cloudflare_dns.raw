!impostor and !loopback and
 ((outbound and 
 (!tcp or tcp.Syn or tcp.Rst or tcp.Fin or tcp.PayloadLength>0) 
 and 
 ((tcp.DstPort == 443)) 
 and 
 (ip.DstAddr == 1.1.1.1 or ip.DstAddr == 1.0.0.1)
 and
 (((ip.DstAddr < 127.0.0.1 or ip.DstAddr > 127.255.255.255) and 
 (ip.DstAddr < 10.0.0.0 or ip.DstAddr > 10.255.255.255) and 
 (ip.DstAddr < 192.168.0.0 or ip.DstAddr > 192.168.255.255) and 
 (ip.DstAddr < 172.16.0.0 or ip.DstAddr > 172.31.255.255) and 
 (ip.DstAddr < 169.254.0.0 or ip.DstAddr > 169.254.255.255)) 
 or 
 ((ipv6.DstAddr > ::1) and (ipv6.DstAddr < 2001::0 or ipv6.DstAddr >= 2001:1::0) and 
 (ipv6.DstAddr < fc00::0 or ipv6.DstAddr >= fe00::0) and 
 (ipv6.DstAddr < fe80::0 or ipv6.DstAddr >= fec0::0) and 
 (ipv6.DstAddr < ff00::0 or ipv6.DstAddr >= ffff::0))))
  or
  (inbound and tcp and 
  ((tcp.Ack and tcp.Syn or tcp.Rst or tcp.Fin) or 
  (tcp.PayloadLength>=12 and 
  tcp.Payload32[0]==0x48545450 and 
  tcp.Payload16[2]==0x2F31 and 
  tcp.Payload[6]==0x2E and 
  tcp.Payload16[4]==0x2033 and 
  tcp.Payload[10]==0x30 and 
  (tcp.Payload[11]==0x32 or tcp.Payload[11]==0x37))) 
  and 
  ((tcp.SrcPort == 443)) 
  and 
  (ip.SrcAddr == 1.1.1.1 or ip.SrcAddr == 1.0.0.1)
 and
  (((ip.SrcAddr < 127.0.0.1 or ip.SrcAddr > 127.255.255.255) and 
  (ip.SrcAddr < 10.0.0.0 or ip.SrcAddr > 10.255.255.255) and 
  (ip.SrcAddr < 192.168.0.0 or ip.SrcAddr > 192.168.255.255) and 
  (ip.SrcAddr < 172.16.0.0 or ip.SrcAddr > 172.31.255.255) and 
  (ip.SrcAddr < 169.254.0.0 or ip.SrcAddr > 169.254.255.255)) or 
  ((ipv6.SrcAddr > ::1) and (ipv6.SrcAddr < 2001::0 or ipv6.SrcAddr >= 2001:1::0) and 
  (ipv6.SrcAddr < fc00::0 or ipv6.SrcAddr >= fe00::0) and 
  (ipv6.SrcAddr < fe80::0 or ipv6.SrcAddr >= fec0::0) and 
  (ipv6.SrcAddr < ff00::0 or ipv6.SrcAddr >= ffff::0)))))
